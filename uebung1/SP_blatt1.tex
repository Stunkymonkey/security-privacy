\documentclass[12pt,pdftex,a4paper]{article}
\usepackage[ngerman]{babel}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{ulem}
\usepackage{bbm}
\usepackage{array}
\usepackage{marvosym}
\usepackage{color}
\usepackage{hhline}
\usepackage[pdftex]{graphicx}
\usepackage{listings}
\lstset{language=Python,basicstyle=\footnotesize}
\usepackage{pdfpages}
\usepackage{booktabs}
\PassOptionsToPackage{hyphens}{url}
\usepackage{hyperref}
\usepackage{extarrows}
\usepackage{rotating}
\newcommand\tab[1][1cm]{\hspace*{#1}}

\title{Security and Privacy,\\ Blatt 1}
\author{Franziska Hutter (3295896)\\
	Felix Truger (3331705)\\
	Felix BÃ¼hler (2973410)}


\begin{document}
\maketitle
\pagebreak

\section*{Problem 1: Specification of Protocols}
Formal specification of the Woo and Lam Mutual Authentication Protocol:
\\~\\
P = (\{$\Pi_1$, $\Pi_2$, $\Pi_3$\}, $\mathcal{W}$)\\~\\
with\\~\\
$\mathcal{W}$ = \{A, B, S\}\\~\\

$\Pi_1 = \Pi_A^{i,B} =$
\begin{enumerate}
	\item \tab $ A \rightarrow \langle A, N_A\rangle $
	\item \tab $ \langle B, x \rangle \rightarrow \{\langle A, \langle B, \langle N_A, x\rangle\rangle\rangle\}_{K_{AS}}^s$	
	\item \tab $ \{\langle B,\langle N_A, \langle x, y\rangle\rangle\rangle\}_{K_{AS}}^{s}, \{\langle N_A, x\rangle\}_y^s \rightarrow \{x\}_y^s $
\end{enumerate} 

$\Pi_2 = \Pi_B^{r,A} =$
\begin{enumerate}
\item \tab $\langle A, x\rangle \rightarrow \langle B, N_B \rangle$
\item \tab $\{\langle A, \langle B, \langle x, N_B \rangle\rangle\rangle\}_{K_{AS}}^s
\rightarrow \{\langle B,\langle x, \langle N_B, K_{AB}\rangle\rangle\rangle\}_{K_{AS}}^{s}, \{\langle x, N_B\rangle\}_{K_{AB}}^s$
\item \tab $ \{N_B\}_{K_{AB}}^s \rightarrow \{secret\}_{K_{AB}}^s$
\end{enumerate}

% I'm not sure whether this is really necessary 
$\Pi_3 = \Pi_B^{i,S} =$
\begin{enumerate}
\item \tab $ B \rightarrow \{\langle A, \langle B, \langle x, N_B \rangle\rangle\rangle\}_{K_{AS}}^s, \{\langle A, \langle B, \langle x, N_B \rangle\rangle\rangle\}_{K_{BS}}^s $
%\item \tab $ \{\langle B, \langle x, \langle N_B, y\rangle\rangle\rangle\}_{K_{AS}}^s,\{\langle A, \langle x, \langle N_B, y\rangle\rangle\rangle\}_{K_{BS}}^s $
\end{enumerate}

$\Pi_4 = \Pi_S^{r,B} =$
\begin{enumerate}
\item \tab $ \{\langle A, \langle B, \langle x, y\rangle\rangle\rangle\}_{K_{AS}}^s, \{\langle A, \langle B, \langle x, y\rangle\rangle\rangle\}_{K_{BS}}^s $ \\ \tab $\rightarrow \{\langle B, \langle x, \langle y, K_{AB}\rangle\rangle\rangle\}_{K_{AS}}^s,\{\langle A, \langle x, \langle y, K_{AB}\rangle\rangle\rangle\}_{K_{BS}}^s $
\end{enumerate}

\newpage
\section*{Problem 2: Attacks on Protocols}
Formal description of an attack on the Woo and Lam Mutual Authentication Protocol:\\~\\
% Formal description of the instances of the protocol
Protocol P = $(\{\Pi_1, ..., \Pi_n\}, \mathcal{W}), n \in \{1,...,7\}$ \\~\\
with\\~\\
$\mathcal{W}$ = \{I, A, B, S, $K_{IS}$\}\\~\\
$\Pi_i = \Pi_j$ as described in problem 1 for $i,j\in \{1,2,3,4\}\land i=j$ where both, the roles of A and S are performed by the Attacker I, denoted as $I_A$ and $I_S$.\\~\\

$\Pi_5 = \Pi_A^{i,B} =$
\begin{enumerate}
	\item \tab $ A \rightarrow \langle A, N_A'\rangle $
	\item \tab $ \langle B, x \rangle \rightarrow \{\langle A, \langle B, \langle N_A', x\rangle\rangle\rangle\}_{K_{AS}}^s$	
	\item \tab $ \{\langle B,\langle N_A', \langle x, y\rangle\rangle\rangle\}_{K_{AS}}^{s}, \{\langle N_A', x\rangle\}_y^s \rightarrow \{x\}_y^s $
\end{enumerate}

$\Pi_6 = \Pi_B^{r,A} =$
\begin{enumerate}
\item \tab $\langle A, x\rangle \rightarrow \langle B, N_B' \rangle$
\item \tab $\{\langle A, \langle B, \langle x, N_B' \rangle\rangle\rangle\}_{K_{AS}}^s
\rightarrow \{\langle B,\langle x, \langle N_B', K_{AB}\rangle\rangle\rangle\}_{K_{AS}}^{s}, \{\langle x, N_B'\rangle\}_{K_{AB}}^s$
\item \tab $ \{N_B'\}_{K_{AB}}^s \rightarrow \{secret\}_{K_{AB}}^s$
\end{enumerate}

$\Pi_7 = \Pi_B^{i,S} =$
\begin{enumerate}
\item \tab $ B \rightarrow \{\langle A, \langle B, \langle x, N_B' \rangle\rangle\rangle\}_{K_{AS}}^s, \{\langle A, \langle B, \langle x, N_B' \rangle\rangle\rangle\}_{K_{BS}}^s $
%\item \tab $ \{\langle B, \langle x, \langle N_B, y\rangle\rangle\rangle\}_{K_{AS}}^s,\{\langle A, \langle x, \langle N_B, y\rangle\rangle\rangle\}_{K_{BS}}^s $
\end{enumerate}\

where $\Pi_5$ through $\Pi_7$ ressemble the second session of the protocol\\~\\
% formal description of the actual attack, which consists of the execution ordering of P and some substitutions for the variables in the instances of P
Attack $\mathcal{A}_{WLMAP} = (\pi, \sigma) $ \\~\\
with\\~\\
$\pi = $ the execution ordering for $ P =$ (1, 2, 1, 3, 5, 6, 5, 7, 4, 2, 1, 2) \\~\\
and \\~\\
$\sigma =? $


\section*{Problem 3: Security Proof by Hand}
$\mathcal{W}$ = $\{I, A, B\}$ (initial intruder knowledge). Let $\mathcal{L}$ be the set of messages, that the intruder could ever accumulate throughout the execution of P. $\mathcal{L}$ = $\{\{K, A\}_{K_{AS}}^s, \{secret\}_K^s\}$.\newline Note: Since the intruder knows the rules of the protocol, he will be able to conclude that K is the key to decrypt the secret.\newline
The secret would be revealed to the intruder if the following holds: $secret\in d(\mathcal{W}\cup\mathcal{L})$. Since $K_{AS} \notin (\mathcal{W}\cup\mathcal{L})$ and $K \notin (\mathcal{W}\cup\mathcal{L})$, not futher knowledge can be derived from $(\mathcal{W}\cup\mathcal{L})$. Thus the given protocol is secure in terms that the secret is never revealed to the intruder.
%Todo: Maybe also check for the security of authentication.

\section*{Problem 4: AVISPA Tool: Woo and Lam Attack}

\section*{Problem 5: AVISPA Tool: Woo and Lam Fix}

\section*{Problem 6: Reduction from G3C}

\end{document}
